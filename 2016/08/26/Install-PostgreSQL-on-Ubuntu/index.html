<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Install PostgreSQL on Ubuntu · iuhoay's blog</title><meta name="description" content="Install PostgreSQL on Ubuntu - iuhoay"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://iuhoay.com/atom.xml" title="iuhoay's blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/iuhoay" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Install PostgreSQL on Ubuntu</h1><div class="post-info">2016年8月26日</div><div class="post-content"><p>安装 PostgreSQL 9.5</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ sudo sh -c <span class="string">'echo "deb http://apt.postgresql.org/pub/repos/apt/ $(lsb_release -cs)-pgdg main" &gt; /etc/apt/sources.list.d/pgdg.list'</span></div><div class="line">$ sudo apt-get install wget ca-certificates</div><div class="line">$ wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -</div><div class="line">$ sudo apt-get update</div><div class="line">$ sudo apt-get upgrade</div><div class="line">$ sudo apt-get install postgresql-9.5</div></pre></td></tr></table></figure>
<a id="more"></a>
<p>安装完成，使用 <code>postgres</code> 用户登录控制台</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ sudo su - postgres</div><div class="line">postgres@:~$ psql</div><div class="line">psql (9.5.4)</div><div class="line">Type <span class="string">"help"</span> <span class="keyword">for</span> help.</div><div class="line"></div><div class="line">postgres=<span class="comment">#</span></div></pre></td></tr></table></figure>
<p>使用 <code>\password</code> 命令设置密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">postgres=# \password postgres</div></pre></td></tr></table></figure>
<p>使用 <code>\q</code> 命令退出控制台</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">postgres=# \q</div></pre></td></tr></table></figure>
<p>使用 shell 创建数据库用户</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ sudo -u postgres createuser --superuser dbuser</div><div class="line">$ sudo -u postgres psql</div><div class="line">postgres=<span class="comment"># \password dbuser</span></div><div class="line">postgres=<span class="comment"># \q</span></div></pre></td></tr></table></figure>
<p>为 <code>dbuser</code> 创建数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo -u postgres createdb -O dbuser exampledb</div></pre></td></tr></table></figure>
<p>使用 <code>dbuser</code> 登录数据库并打开 <code>exampledb</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ psql -U dbuser -d exampledb -h 127.0.0.1 -p 5432</div></pre></td></tr></table></figure>
<p><code>-U</code> 指定用户 <code>-d</code> 指定表 <code>-h</code> 指定服务器 <code>-p</code> 指定端口</p>
<p>打开远程访问</p>
<p>打开 <code>/etc/postgresql/9.5/main/postgresql.conf</code>，找到 <code>listen_addresses</code> 替换为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">listen_addresses = &apos;*&apos;</div></pre></td></tr></table></figure>
<p>修改 <code>/etc/postgresql/9.5/main/pg_hba.conf</code>，找到 <code>host   all   all   127.0.0.1/32    md5</code> 替换为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># TYPE  DATABASE  USER    ADDRESS     METHOD</div><div class="line">host    all       all     0.0.0.0/0   md5</div></pre></td></tr></table></figure>
<p>执行 <code>sudo service postgresql restart</code> 重启服务</p>
<p>最后使用外部 ip 访问</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ psql -U dbuser -d exampledb -h 192.168.1.233</div></pre></td></tr></table></figure>
</div></article></div></section><footer><div class="paginator"><a href="/2016/08/25/make-ubuntu-usb-on-macos/" class="next">NEXT</a></div><div class="copyright"><p>© 2012 - 2016 <a href="http://iuhoay.com">iuhoay</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-44428878-1",'auto');ga('send','pageview');</script></body></html>